#### Problem 1

(a)初始状态为$(x,y,0)$，此时
$$
rs+a =xy
$$
所以初始状态时$P((r,s,a))$成立。

假设在$(r,s,a)$处$P((r,s,a))$成立，下面证明经过转移后该性质也成立。如果$s>0$为偶数，那么转移到$(2r,s/2,a)$，所以
$$
(2r)(s/2)+ a =rs+a=xy
$$
如果如果$s>0$为奇数，那么转移到$(2r,(s-1)/2,a+r)$，所以
$$
2r(s-1)/2 + (a+r)=rs-r+a+r=rs+a=xy
$$
所以经过转移后该性质也成立。

(b)终止条件为$s=0$，所以
$$
rs+a=a=xy
$$
(c)由转移状态可知，每次状态转移， $s$至少减少一半，注意$s$的初始值为$y$，所以由除法的含义可知，转移次数最多为$y$的二进制表示的长度。



#### Problem 2

(a)初始状态为
$$
([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],(4,4))
$$
目标状态为
$$
([15,14,13,12,11,10,9,8,7,6,5,4,3,2,1],(4,4))
$$
(b)因为$i$相等， 所以只要比较两者的$P(L)$即可，初始状态的$P(L)=0$，目标状态的$P(L)>0$，两者的parity不相等。

(c)如果横向移动空格，那么$L$不变，因为此时$i$不变，所以parity不变。如果纵向移动空格，不妨设向下移动（向上移动同理），假设位于$(i-1,j)$位置的元素在$L$的位置为$k$，那么该移动只会影响$L[k]$和$L[k+1],L[k+2],L[k+3]$的相对位置，移动后的次序为
$$
L[k+1],L[k+2],L[k+3],L[k]
$$
与之前的次序
$$
L[k],L[k+1],L[k+2],L[k+3]
$$
相比，相当于交换三次相邻元素，因为每次交换相邻元素逆序数增加或减少$1$，所以该操作会改变$P(L)$的奇偶性，结合$j$变成$j+1$可得$P(L)+j$的奇偶性不变，因此结论成立。



#### Problem 3

(a)进大桥的状态转移为
$$
(A,B,C)\to (A+3,B,C+1)
$$
出大桥的状态转移为
$$
(A,B,C)\to (A,B+2,C-1)
$$
(b)显然$A,B$都为WI，由状态转移可知$A+B$为SI。不难验证
$$
2A-3B-6C
$$
为常数，记
$$
D_0=2A_0-3B_0 -6C_0
$$
因此
$$
2A-3B-6C =D_0
$$
所以
$$
A-B = \frac 1 2 (6C+B+D_0)
$$
由状态转移可知$6C+B​$可能增加，也可能减少，所以$A-B​$为N。注意到
$$
3C-A =-\frac 3 2 B-\frac 1 2 D_0
$$
所以$3C-A$是WD，同理可知$2A-3B,B+3C$是N。由等式可知$2A-3B-6C$是constant以及
$$
2A-2B-3C =B+3C+D_0
$$
所以$2A-2B-3C ​$是N。

(c)（参考05版解答）

由(b)可知
$$
2A-3B-6C = D_0
$$
所以这是一个不变性质。另一个不变性质为$C\le 1000$，下面来验证这点。注意能上桥的条件为
$$
A-B <T_0
$$
假设我们从状态$(A,B,C)​$转移到$(A',B',C')​$，将恒等式变形可得
$$
\begin{aligned}
6C'&= 2A'-3B'-D_0\\
&=2(A'-B')-(B'+D_0) \\
&\le 2(A+3-B) - (B+D_0) \\
&=6+2(A-B)-(B+D_0) \\
&< 6+2T_0-B-D_0 \\
&\le 6+2T_0-B_0-D_0 \\
&=6+6000-6C_0+2A_0-2B_0-B_0-D_0\\
&=6006
\end{aligned}
$$
其中第一个不等号是因为
$$
A'-B'=A+3-B或A-B-2
$$
以及$B$非降，因此
$$
A'-B' \le A+3-B
$$
第二个不等号是因为
$$
A-B <T_0
$$
最后一个不等号是因为$B$非降。

由上述讨论可得
$$
C' < 1001\\
C'\le 1000
$$
所以结论得证。

(d)因为当一辆车进出之后，$A-B$增加$1$，所以当进出了$3000$辆车之后，我们有
$$
A-B\ge 3000+ A_0 -B_0 > T_0
$$
此时就无法上桥了。当再过最多$1000$次状态转换后，桥上没有车，这样就会产生桥为空，但是无法上桥的情形。



#### Problem 4

定义全体感染学生的周长为恰有一侧有感染学生的边的数量，那么每次状态转移，最多增加两条边，至少减少两条边，所以周长非增。如果可以感染全体成员，那么最终的周长为$4n$，但是初始状态边长小于$4n$，这就产生了矛盾。

